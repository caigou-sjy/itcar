<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>首页</title>
    <link rel="stylesheet" href="elementUI/index.css">
    <script src="elementUI/vue.js"></script>
    <script src="elementUI/index.js"></script>
    <script src="elementUI/echarts.js"></script>
    <script src="elementUI/vue-echarts.js"></script>
    <script src="elementUI/axios.min.js"></script>
</head>

<style>
    .el-header {
        background-color: #B3C0D1;
        color: #333;
        line-height: 60px;

    }



    .el-aside {
        color: #333;

    }

    /* 走马灯 */
    .el-carousel__item h3 {
        color: #475669;
        text-align: center;
        font-size: 14px ;
        /* 设置主图透明度 */
        opacity: 1;
        line-height: 600px;
        margin: 0;
    }

    .title {
        text-align: center;
        color: #457eb6;
    }


    .img {
        background-image: url("img/elyy4.png");

        background-size: cover;
    }

    .el-header, .el-footer {
    background-color: #B3C0D1;
    color: #333;
    text-align: center;
    line-height: 60px;
    margin-right: 100px;
  }
  
  .el-aside {
    background-color: #D3DCE6;
    color: #333;
    text-align: center;
    line-height: 100px;
    opacity: 93%;
    margin-left: 100px;
  }
  
  .el-main {
    background-color: #E9EEF3;
    color: #333;
    text-align: center;
    line-height: 50px;
    opacity: 93%;
    margin-right: 100px;
  }
  
  body > .el-container {
    margin-bottom: 40px;
  }
  
  .el-container:nth-child(5) .el-aside,
  .el-container:nth-child(6) .el-aside {
    line-height: 260px;
  }
  
  .el-container:nth-child(7) .el-aside {
    line-height: 320px;
  }
</style>

<body class="img">
    <div id="app">

        <h1 style="margin-left: 100px; color: rgb(220, 235, 240);font-size: 50px;">西安宜老永逸养老平台</h1>
        <el-container>
            <el-aside width="200px" style="background-color: rgb(238, 241, 246)">
                <el-menu :default-openeds="['1', '3']">
                    <el-submenu index="1">
                        <template slot="title"><i class="el-icon-message"></i>个人账号管理</template>
                        <el-menu-item-group>
                            <template slot="title">个人信息管理</template>
                            <el-menu-item index="1-1" @click="getUserInfo()">查看个人信息</el-menu-item>
                            <el-menu-item index="1-2">修改个人信息</el-menu-item>
                        </el-menu-item-group>
                        <el-menu-item-group title="账号管理">
                            <el-menu-item index="1-3">查看账号信息</el-menu-item>
                        </el-menu-item-group>
                        <el-submenu index="1-4">
                            <template slot="title">修改个人信息</template>
                            <el-menu-item index="1-4-1">修改基础信息</el-menu-item>
                            <el-menu-item index="1-4-2">修改密码</el-menu-item>
                        </el-submenu>
                    </el-submenu>
                    <el-submenu index="2">
                        <template slot="title"><i class="el-icon-menu"></i>健康信息管理</template>
                        <el-menu-item-group>
                            <template slot="title">血压信息</template>
                            <el-menu-item index="2-1" @click="getBpressInfo()">查看血压测量记录</el-menu-item>
                            <el-menu-item index="2-2" @click="getHighGraph()">查看变化曲线</el-menu-item>
                        </el-menu-item-group>
                        <el-menu-item-group title="心率信息">
                            <el-menu-item index="2-3">查看心率测量记录</el-menu-item>
                        </el-menu-item-group>
                        <el-submenu index="2-4">
                            <template slot="title">查看变化曲线</template>
                            <!-- <el-menu-item index="2-4-1">选项4-1</el-menu-item> -->
                        </el-submenu>
                    </el-submenu>
                    <el-submenu index="3">
                        <template slot="title"><i class="el-icon-setting"></i>医疗管理</template>
                        <el-menu-item-group>
                            <template slot="title">分组一</template>
                            <el-menu-item index="3-1">选项1</el-menu-item>
                            <el-menu-item index="3-2">选项2</el-menu-item>
                        </el-menu-item-group>
                        <el-menu-item-group title="分组2">
                            <el-menu-item index="3-3">选项3</el-menu-item>
                        </el-menu-item-group>
                        <el-submenu index="3-4">
                            <template slot="title">选项4</template>
                            <el-menu-item index="3-4-1">选项4-1</el-menu-item>
                        </el-submenu>
                    </el-submenu>
                    <el-submenu index="4">
                        <template slot="title"><i class="el-icon-setting"></i>老年兴趣生活</template>
                        <el-menu-item-group>
                            <template slot="title">分组一</template>
                            <el-menu-item index="4-1">选项1</el-menu-item>
                            <el-menu-item index="4-2">选项2</el-menu-item>
                        </el-menu-item-group>
                        <el-menu-item-group title="分组2">
                            <el-menu-item index="4-3">选项3</el-menu-item>
                        </el-menu-item-group>
                        <el-submenu index="4-4">
                            <template slot="title">选项4</template>
                            <el-menu-item index="4-4-1">选项4-1</el-menu-item>
                        </el-submenu>
                    </el-submenu>
                </el-menu>
            </el-aside>

            <el-container>
                <el-header style="text-align: right; font-size: 12px">

                    <el-col :span="12">
                        <div class="demo-basic--circle">
                            <div class="block">
                                <el-avatar :size="50" :src="userPicture"></el-avatar>
                            </div>
                        </div>
                    </el-col>


                    <i class="el-icon-s-home" @click="backToIndex()" style="margin-right: 15px">回到首页</i>


                    <el-dropdown>
                        <i class="el-icon-s-home" style="margin-right: 15px"></i>
                        <el-dropdown-menu slot="dropdown">
                            <!-- <el-dropdown-item ><a href="index.html" style="text-decoration: none;">回到主页</a></el-dropdown-item> -->
                            <el-dropdown-item>新增</el-dropdown-item>
                            <el-dropdown-item>删除</el-dropdown-item>
                        </el-dropdown-menu>
                    </el-dropdown>
                    <span>当前用户：{{username}}</span>
                    <i class="el-icon-error" @click="logout()" style="margin-right: 15px">退出登录</i>
                </el-header>

                <el-main>

                    <div :style="states.showIndex" class="title">
                        <font size="4" face="宋体">
                            <h1>
                                PUBLIC INFORMATION
                            
                                和平新时代 开启幸福晚年生活
                            </h1>
                        </font>
                        <el-carousel height="400px">
                            <el-carousel-item v-for="(img,index) in imgs">
                                <!-- <h3 class="small"> -->
                                <h3 class="medium">
                                    <img :src="img" style="height: 400px;" />
                                </h3>
                            </el-carousel-item>
                        </el-carousel>
                        <font size="4" face="宋体">
                            <h1>
                                MEDICAL + MAINTENANCE
                            </h1>
                            <h1>
                                和平新时代"医疗+养护+康复"正规有资质才更放心
                            </h1>
                        </font>
                        <font size="4" face="宋体">
                            <h1>
                                CHOOSE THE PEOPLE AND TRUST THEM
                            </h1>
                            <h1>
                                越来越多的家属选择我们信任我们
                            </h1>
                        </font>


                    </div>


                    <div :style="states.showUserInfo">
                        
                        <br>
                        <span>当前用户：{{username}}</span>
                        
                        <br>
                        <h3>
                            用户照片：______<img :src="userPicture"
                                width="100px">_______
                        </h3>
                        
                        <br>

                        <el-table :data="userTable" border style="width: 100%">
                            <el-table-column fixed prop="username" label="姓名" width="150">
                            </el-table-column>
                            <el-table-column prop="age" label="年龄" width="120">
                            </el-table-column>
                            <el-table-column prop="gender" label="性别" width="120">
                            </el-table-column>
                            <el-table-column prop="phone" label="电话" width="120">
                            </el-table-column>
                            <el-table-column prop="birth" label="出生日期" width="120">
                            </el-table-column>
                            <el-table-column prop="address" label="地址" width="300">
                            </el-table-column>

                            <el-table-column prop="createtime" label="注册日期" width="120">
                            </el-table-column>
                            <el-table-column fixed="right" label="操作" width="100">
                                <template slot-scope="scope">
                                    <el-button @click="handleClick(scope.row)" type="text" size="small">查看</el-button>
                                    <el-button type="text" size="small">编辑</el-button>
                                </template>
                            </el-table-column>
                        </el-table>
                    </div>

                    <div :style="states.showBpressInfo">
                        
                        <br>
                        <span>当前用户：{{username}}</span>
                        <br>
                       


                        <el-table :data="bpressTable" border style="width: 100%">
                            <el-table-column fixed prop="id" label="记录编号" width="150">
                            </el-table-column>
                            <el-table-column prop="high" label="收缩压(mmgh)" width="120">
                            </el-table-column>
                            <el-table-column prop="low" label="舒张压(mmgh)" width="120">
                            </el-table-column>
                            <el-table-column prop="rate" label="心率(次/分钟)" width="120">
                            </el-table-column>
                            <el-table-column prop="uid" label="用户编号" width="120">
                            </el-table-column>
                            <el-table-column prop="date" label="测量日期" width="120">
                            </el-table-column>


                            <el-table-column fixed="right" label="操作" width="100">
                                <template slot-scope="scope">
                                    <el-button @click="handleClick(scope.row)" type="text" size="small">查看</el-button>
                                    <el-button type="text" size="small">编辑</el-button>
                                </template>
                            </el-table-column>
                        </el-table>
                    </div>

                    <div :style="states.showHighGraph">
                        <div id="highGraph" style="width: 600px; height: 400px;"></div>


                    </div>


                </el-main>

            </el-container>
        </el-container>
    </div>
</body>
<script>
    var myChart = null;

    new Vue({
        el: '#app',
        data() {
            return {

                userPicture: '',
                userId: "-1",
                size: "medium",
                states: {
                    showIndex: 'display:block',
                    showUserInfo: 'display:none',
                    showBpressInfo: 'display:none',
                    showHighGraph: 'display:none',
                },
                username: "未命名",
                userTable: [],
                bpressTable: [],

                option: {
                    xAxis: {
                        type: 'category',
                        data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series: [{
                        data: [150, 230, 224, 218, 135, 147, 260],
                        type: 'line'
                    }]
                },

                imgs: [
                    'img/elyy1.jpg',
                    'img/elyy2.png',
                    'img/elyy3.png',
                    'img/elyy4.png',
                    'img/elyy5.png',
                    'img/elyy6.png',
                    'img/elyy7.png',
                ],

            }
        },
        mounted: function () {
            myChart = echarts.init(document.getElementById('highGraph'));
            myChart.setOption(this.option);
            var _this = this;

            _this.username = localStorage.getItem("username");

            axios.get('../api/user/init')
                .then(function (response) {
                    console.log(response.data);
                    if (response.data.code == 2000) {
                        _this.userPicture = response.data.results.picture;
                        console.log("mounted==>"+_this.userPicture);
                        _this.userId = response.data.results.id;
                        console.log("init():" + _this.userId);
                        console.log("init():" + _this.userPicture);

                    } else {
                        alert("初始化失败，将强制退出");
                        window.location.href = "elyy-login1.html";

                    }
                })
                .catch(function (error) {
                    console.log(error);
                });
        },
        methods: {
            getUserInfo() {
                var _this = this;
                for (var state in _this.states) {
                    _this.states[state] = 'display:none';
                }
                _this.states.showUserInfo = 'display:block';
                axios.get('../api/user/getUserInfo')
                    .then(function (response) {
                        console.log(response.data);
                        if (response.data.code == 2003) {
                            _this.userTable = response.data.results;
                        } else {
                            alert("拉取信息失败，请联系管理员！");
                        }
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            },
            getBpressInfo() {
                var _this = this;
                var _uid = _this.userId;
                for (var state in _this.states) {
                    _this.states[state] = 'display:none';
                }
                _this.states.showBpressInfo = 'display:block';
                console.log("getBpressInfo():" + _this.username);
                console.log("getBpressInfo():" + _this.userId);
                axios.get('../api/bpress/getBpressInfo?uid=' + _uid)
                    .then(function (response) {
                        console.log(response.data);
                        if (response.data.code == 2006) {
                            _this.bpressTable = response.data.results;
                            console.log(_this.bpressTable);
                        } else {
                            alert("拉取信息失败，请联系管理员！");
                        }
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            },
            getHighGraph() {
                var _this = this;
                var _uid = _this.userId;
                for (var state in _this.states) {
                    _this.states[state] = 'display:none';
                }
                _this.states.showHighGraph = 'display:block';

                console.log("getHighGraph():" + _this.uid);
                axios.get('../api/bpress/getHighGraph?uid=' + _uid)
                    .then(function (response) {
                        console.log(response.data);
                        if (response.data.code == 2007) {
                            var _vo = response.data.results;
                            _this.option.xAxis.data = _vo.x;
                            _this.option.series[0].data = _vo.y;
                            myChart.setOption(_this.option);

                        } else {
                            alert("拉取信息失败，请联系管理员！");
                        }
                    })
                    .catch(function (error) {
                        console.log(error);
                    });


            },
            backToIndex() {
                var _this = this;
                for (var state in _this.states) {
                    _this.states[state] = 'display:none';
                }

                _this.states.showIndex = 'display:block';
            },
            logout() {
                axios.get('../api/user/logout')
                    .then(function (response) {
                        console.log(response.data);
                        if (response.data.code == 2004) {
                            alert("已退出！");
                            window.location.href = "login.html";
                        } else {
                            alert("退出失败，将强制退出");
                            window.location.href = "elyy-login1.html";

                        }
                    })

                    .catch(function (error) {
                        console.log(error);
                    });
            }



        }
    });
</script>

</html>